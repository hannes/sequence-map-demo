# name: test/sql/sequence_map.test
# description: test sequence_map extension
# group: [sequence_map]

# Before we load the extension, this will fail
statement error
SELECT sequence_map('Sam');
----
Catalog Error: Scalar Function with name sequence_map does not exist!

# Require statement will ensure this test is run with this extension loaded
require sequence_map

# Confirm the extension works
query I
SELECT sequence_map('GGTGCAGCTCGTGGAGTCTGGGGGGTCTCTGAGACTCTCCTGTGCTGTCTCTGGAAGCTTCGTGAATATCAATGGGATGACCTGGTACCGCCAGGCTCCAGGGAAGCAGCGCGAATTAGTCGCGCGTGTTCGTGGCGGAACCACAGTCTATGCAGACTCCGTGAAGGGGCGATTCACCATCTCCACAAACTACACCAAGAAAACGCAAGATCTGCAAATGACCAGTCTGAAACCGGAGGACAGTGGCGTCTATTATTGTAATCTTGGGCCGGCCTGGGGCCAGGGGACCCATGTGACCGTCTCCTCAGAACCCAAGACACCAAAACCAC');
----
GAARGVWGVSETLLCCLWKLREYQWDDLVPPGSREAARISRACSWRNHSLCRLREGAIHHLHKLHQENARSANDQSETGGQWRLLL*SWAGLGPGDPCDRLLRTQDTKT

query I
SELECT length(sequence_map('GGTGCAGCTCGTGGAGTCTGGGGGGTCTCTGAGACTCTCCTGTGCTGTCTCTGGAAGCTTCGTGAATATCAATGGGATGACCTGGTACCGCCAGGCTCCAGGGAAGCAGCGCGAATTAGTCGCGCGTGTTCGTGGCGGAACCACAGTCTATGCAGACTCCGTGAAGGGGCGATTCACCATCTCCACAAACTACACCAAGAAAACGCAAGATCTGCAAATGACCAGTCTGAAACCGGAGGACAGTGGCGTCTATTATTGTAATCTTGGGCCGGCCTGGGGCCAGGGGACCCATGTGACCGTCTCCTCAGAACCCAAGACACCAAAACCAC'));
----
109

query I
SELECT translate_sequence('', 1, -1, 'type\\tstart\\tend\\tlabel\\nFR\\t2\\t52\\tFR-H1\\nFR\\t77\\t127\\tFR-H2\\nFR\\t146\\t259\\tFR-H3\\nFR\\t275\\t307\\tFR-H4\\ngene\\t15\\t261\\tIGHV3-d*01\\ngene\\t273\\t308\\tIGHJ5*02\\nMutation\\t2\\t4\\tG9V\\nMutation\\t5\\t7\\tV10Q\\nMutation\\t14\\t16\\tQ13E\\nMutation\\t17\\t19\\tP14S\\nMutation\\t47\\t49\\tA24V\\nWarning\\t2\\t52\\t''FR-H1'' is truncated (start)\\nMutation\\t80\\t82\\tS35T\\nMutation\\t86\\t88\\tV37Y\\nMutation\\t107\\t109\\tG44Q\\nMutation\\t110\\t112\\tL45R\\nMutation\\t116\\t118\\tW47L\\nMutation\\t122\\t124\\tS49A\\nMutation\\t125\\t127\\tS50R\\nMutation\\t146\\t148\\tY57V\\nMutation\\t161\\t163\\tR62V\\nMutation\\t185\\t187\\tR70T\\nMutation\\t188\\t190\\tD71N\\nMutation\\t191\\t193\\tN72Y\\nMutation\\t194\\t196\\tS73T\\nMutation\\t200\\t202\\tN75K\\nMutation\\t206\\t208\\tL77Q\\nMutation\\t209\\t211\\tH78D\\nMutation\\t221\\t223\\tN82T\\nMutation\\t230\\t232\\tR85K\\nMutation\\t233\\t235\\tA86P\\nMutation\\t242\\t244\\tT89S\\nMutation\\t245\\t247\\tA90G\\nMutation\\t290\\t292\\tL11H\\nCDR\\t53\\t76\\tCDR-H1\\nCDR\\t128\\t145\\tCDR-H2\\nCDR\\t260\\t274\\tCDR-H3\\nCDS\\t2\\t307\\tIgG-H\\nWarning\\t188\\t196\\tGlycosylation\\ngene\\t1\\t267\\tIGHV3S53*01\\nFR\\t2\\t52\\tFR-H1\\nMutation\\t2\\t4\\tG9V\\nMutation\\t5\\t7\\tG10Q\\nMutation\\t14\\t16\\tQ13E\\nMutation\\t17\\t19\\tP14S\\nMutation\\t47\\t49\\tA24V\\nWarning\\t2\\t52\\t''FR-H1'' is truncated (start)\\nFR\\t77\\t127\\tFR-H2\\nMutation\\t80\\t82\\tG35T\\nMutation\\t125\\t127\\tA50R\\nFR\\t146\\t259\\tFR-H3\\nMutation\\t146\\t148\\tN58V\\nMutation\\t185\\t187\\tR71T\\nMutation\\t188\\t190\\tD72N\\nMutation\\t191\\t193\\tN73Y\\nMutation\\t194\\t196\\tA74T\\nMutation\\t200\\t202\\tN76K\\nMutation\\t206\\t208\\tV78Q\\nMutation\\t209\\t211\\tY79D\\nMutation\\t221\\t223\\tN83T\\nMutation\\t242\\t244\\tT90S\\nMutation\\t245\\t247\\tA91G\\ngene\\t263\\t307\\tIGHJ6*01\\nFR\\t275\\t307\\tFR-H4\\nMutation\\t290\\t292\\tQ10H\\nCDR\\t53\\t76\\tCDR-H1\\nCDR\\t128\\t145\\tCDR-H2\\nCDR\\t260\\t274\\tCDR-H3\\nCDS\\t2\\t307\\tIgG-H\\n', 'GGTGCAGCTCGTGGAGTCTGGGGGGTCTCTGAGACTCTCCTGTGCTGTCTCTGGAAGCTTCGTGAATATCAATGGGATGACCTGGTACCGCCAGGCTCCAGGGAAGCAGCGCGAATTAGTCGCGCGTGTTCGTGGCGGAACCACAGTCTATGCAGACTCCGTGAAGGGGCGATTCACCATCTCCACAAACTACACCAAGAAAACGCAAGATCTGCAAATGACCAGTCTGAAACCGGAGGACAGTGGCGTCTATTATTGTAATCTTGGGCCGGCCTGGGGCCAGGGGACCCATGTGACCGTCTCCTCAGAACCCAAGACACCAAAACCAC');
----
GAARGVWGVSETLLCCLWKLREYQWDDLVPPGSREAARISRACSWRNHSLCRLREGAIHHLHKLHQENARSANDQSETGGQWRLLL*SWAGLGPGDPCDRLLRTQDTKT
